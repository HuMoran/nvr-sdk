# MQTT_DATA

采集设备定时通过MQTT发送此数据给前端
图片暂时采用Base64编码后通过MQTT上传，需试验下，如有问题，再换其他方式
所有数据通过一个MQTT topic，一次发送，暂不做topic区分
历史数据查询等调通后，在讨论设计

## 数据内容

```json
{
  "time": "2019-09-01 06:57:36", // 数据采集时间
  "devType": 2216, // 设备类型：86N-E8(/N/P)系列NVR，包括8/16/32路设备
  "diskNum": 1, // 硬盘个数
  "chanMax": 0, // 设备支持的模拟通道最大个数
  "IPChanMax": 16, // 设备支持的IP通道最大个数
  "disks": [{ // 硬盘具体信息
    "no": 0, // 硬盘号，取值范围：0-33
    "capacity": 953869, // 硬盘容量，单位：MB
    "freeSpace": 0, // 硬盘剩余空间，单位：MB
    "status": 0, // 硬盘状态，具体定义见后文diskStatus
    "type": 0, // 硬盘类型：0-本地硬盘，1-ESATA硬盘，2-NFS硬盘，3-iSCSI硬盘，4-RAID虚拟磁盘，5-SD卡，6-minSAS
    "group": 1, // 该硬盘属于哪个盘组，取值范围1-16
  }],
  "IPChans": [{ // IP通道信息
    "no": 33, // IP通道号
    "isOnline": true, // 是否在线
    "ip": "192.168.1.108",
  }],
  "recordCfg": [{ // 数组内的对象，代表一个通道的录像配置
    "chanNo": 33, // 通道号
    "isRecord": true, // 是否启用录像
    "details": [{ // 分别记录周一到周日的录像配置情况
      "isAllDayRecord": false, // 是否全天录像
      "recordType": 3, // 定义见后文recordType
      "recordSchedule": [{  // 如果不是全天录像，则查看此数组，获取录像时间段配置，最多8组
        "startHour": 8,
        "startMin": 0,
        "stopHour": 12,
        "stopMin": 1,
      }],
    }]
  }],
  "records": [{ // 录像文件信息，每个Object存放一个IP通道的录像文件信息
    "chanNo": 33, // 通道号
    "startTime": "2019-08-01 00:00:00", // 查询的录像文件的开始时间
    "stopTime": "2019-09-01 00:00:00", // 查询录像文件的结束时间
    "files": [{
      "filename": "ch0002_00000000002000300",
      "startTime": "2019-8-1 2:20:23",
      "stopTime": "2019-8-5 12:20:23",
      "size": 112213121,
      "fileType": 0, // 等同于recordType
    }]
  }],
  "screenshots":[{
    "chanNo": 33,
    "time": "2019-09-01 00:00:00",
    "img": "imgToBase64" // 这里还需确认下图片大小，以及能不能通过阿里MQTT把图片转码成base64传过去
  }]
}
```

## 字段定义

### diskStatus

0－正常，1－未格式化，2－错误，3－S.M.A.R.T状态，4－不匹配，5－休眠，6-未连接状态（ 网络硬盘），7-虚拟磁盘正常且支持扩容，10-硬盘正在修复，11-硬盘正在格式化，12-硬盘正在等待格式化，13-硬盘已卸载，14-本地硬盘不存在，15-正在删除（网络硬盘），16-已锁定

### recordType

0-定时录像，1-移动侦测录像，2-报警录像，3-移动侦测或报警录像，4-移动侦测和报警录像，5-命令触发录像，6-智能报警录像，10-PIR报警，11-无线报警，12-呼救报警，13-全部事件(移动侦测、PIR、无线、呼救等所有报警类型的"或"），14-智能交通事件，15-越界侦测，16-区域入侵侦测，17-音频异常侦测，18-场景变更侦测，19-智能侦测（越界侦测|区域入侵侦测|进入区域侦测|离开区域侦测|人脸侦测），20-人脸侦测，21-POS录像，22-进入区域侦测，23-离开区域侦测，24-徘徊侦测，25-人员聚集侦测，26-快速运动侦测，27-停车侦测，28-物品遗留侦测，29-物品拿取侦测，30-火点检测，35-船只检测, 36-测温预警，37-测温报警，38-温差报警，39-离线测温报警，40-防区报警，41-紧急求助，42-业务咨询，43-起身检测，44-折线攀高，45-如厕超时
